Imports System.Net.Mail
Imports System.Net

Public Class mail

    Public Shared Sub send_mail(ByVal to_mail As String, ByVal subject As String, ByVal body As String)
        Try
            Dim from_mail As String = "WAVE@DENSO.COM.TW"

            Dim mail As MailMessage = New MailMessage(from_mail, to_mail) '收件者
            mail.BodyEncoding = Encoding.UTF8
            mail.Subject = subject '標題
            mail.IsBodyHtml = True
            ' mail.CC.Add(CC) 'CC

            Dim html As String = "表單連結:</br><html><head><title></title></head><body> http://wa1040005/Exception_handle.aspx?id=" & body & "</body></html>"
            mail.Body = html  '內文

            Dim smtp As SmtpClient = New SmtpClient("172.30.1.1", 25)
            Dim nc As NetworkCredential = New NetworkCredential("0013", "0013")
            smtp.UseDefaultCredentials = False
            smtp.Credentials = nc
            smtp.Send(mail)

        Catch ex As Exception
            Dim str As String = ex.Message
        End Try
    End Sub

    Public Shared Sub send_mail1(ByVal to_mail As String, ByVal CC As String, ByVal subject As String, ByVal body As String)
        Try
            Dim from_mail As String = "WAVE@DENSO.COM.TW"

            Dim mail As MailMessage = New MailMessage(from_mail, to_mail) '收件者
            mail.BodyEncoding = Encoding.UTF8
            mail.Subject = subject '標題
            mail.IsBodyHtml = True
            mail.CC.Add(CC) 'CC

            Dim html As String = "表單連結:</br><html><head><title></title></head><body> http://wa1040005/Exception_handle.aspx?id=" & body & "</body></html>"
            mail.Body = html  '內文

            Dim smtp As SmtpClient = New SmtpClient("172.30.1.1", 25)
            Dim nc As NetworkCredential = New NetworkCredential("0013", "0013")
            smtp.UseDefaultCredentials = False
            smtp.Credentials = nc
            smtp.Send(mail)

        Catch ex As Exception
            Dim str As String = ex.Message
        End Try
    End Sub
End Class
